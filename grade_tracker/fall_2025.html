<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CHEM 1A Grade Tracker</title>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- React and ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <!-- Babel Standalone for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- Confetti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const CHEM1ATracker = () => {
      const objectives = [1, 3, 4, 5, 6, 7, 8, 9, 10, 11];
      const spirals = [1, 2, 3, 4, 5, 6];
      const labs = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];

      const [checkpoints, setCheckpoints] = useState(objectives.reduce((acc, obj) => ({ ...acc, [obj]: false }), {}));
      const [mindMaps, setMindMaps] = useState(objectives.reduce((acc, obj) => ({ ...acc, [obj]: false }), {}));
      const [spiralAssignments, setSpiralAssignments] = useState(spirals.reduce((acc, s) => ({ ...acc, [s]: false }), {}));
      const [labAssignments, setLabAssignments] = useState(labs.reduce((acc, l) => ({ ...acc, [l]: false }), {}));
      const [lectureFinal, setLectureFinal] = useState(false);
      const [labFinal, setLabFinal] = useState(false);

      useEffect(() => {
        lucide.createIcons();
      }, [checkpoints, mindMaps, spiralAssignments, labAssignments, lectureFinal, labFinal]);

      const fireConfetti = () => {
        if (window.confetti) {
          window.confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 }
          });
        }
      };

      const toggleItem = (setter, key) => {
        setter(prev => {
          const newState = { ...prev, [key]: !prev[key] };
          if (!prev[key]) fireConfetti();
          return newState;
        });
      };

      const calculateGrade = (completed, gradeScale) => {
        const count = completed;
        for (const [threshold, grade] of Object.entries(gradeScale).sort((a, b) => b[0] - a[0])) {
          if (count >= parseInt(threshold)) return grade;
        }
        return 'F';
      };

      const checkpointsCompleted = Object.values(checkpoints).filter(Boolean).length;
      const mindMapsCompleted = Object.values(mindMaps).filter(Boolean).length;
      const spiralsCompleted = Object.values(spiralAssignments).filter(Boolean).length;
      const labsCompleted = Object.values(labAssignments).filter(Boolean).length;

      const checkpointGrade = calculateGrade(checkpointsCompleted, { 10: 'A', 8: 'B', 7: 'C', 6: 'D' });
      const mindMapGrade = calculateGrade(mindMapsCompleted, { 10: 'A', 8: 'B', 7: 'C', 6: 'D' });
      const labGrade = calculateGrade(labsCompleted, { 11: 'A', 10: 'B', 9: 'C', 8: 'D' });
      const spiralsComplete = spiralsCompleted === 6;
      const finalsComplete = lectureFinal && labFinal;

      const getOverallGrade = () => {
        if (!spiralsComplete) return 'Incomplete - All 6 Spirals Required';
        
        const grades = [checkpointGrade, mindMapGrade, labGrade];
        const gradePoints = { 'A': 4, 'B': 3, 'C': 2, 'D': 1, 'F': 0 };
        
        const minPoints = Math.min(...grades.map(g => gradePoints[g]));
        
        if (minPoints >= 4) return 'A';
        if (minPoints >= 3) return 'B';
        if (minPoints >= 2) return 'C';
        if (minPoints >= 1) return 'D';
        return 'F';
      };

      const weeksRemaining = () => {
        const end = new Date('2025-12-12');
        const now = new Date();
        const weeksLeft = Math.ceil((end - now) / (7 * 24 * 60 * 60 * 1000));
        return Math.max(0, weeksLeft);
      };

      const exportData = () => {
        const data = {
          checkpoints,
          mindMaps,
          spiralAssignments,
          labAssignments,
          lectureFinal,
          labFinal
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `chem1a-progress-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
      };

      const importData = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (event) => {
            try {
              const data = JSON.parse(event.target.result);
              setCheckpoints(data.checkpoints);
              setMindMaps(data.mindMaps);
              setSpiralAssignments(data.spiralAssignments);
              setLabAssignments(data.labAssignments);
              setLectureFinal(data.lectureFinal);
              setLabFinal(data.labFinal);
              fireConfetti();
            } catch (err) {
              alert('Error loading file. Please check the file format.');
            }
          };
          reader.readAsText(file);
        }
      };

      const CheckboxItem = ({ checked, onChange, label }) => (
        <div 
          onClick={onChange}
          className="flex items-center gap-2 p-2 hover:bg-blue-50 rounded cursor-pointer transition-colors"
        >
          {checked ? (
            <i data-lucide="check-circle-2" className="w-5 h-5 text-green-600"></i>
          ) : (
            <i data-lucide="circle" className="w-5 h-5 text-gray-400"></i>
          )}
          <span className={checked ? 'text-gray-900 font-medium' : 'text-gray-600'}>{label}</span>
        </div>
      );

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 p-6">
          <div className="max-w-7xl mx-auto">
            {/* Header */}
            <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
              <div className="flex justify-between items-start mb-4">
                <div>
                  <h1 className="text-3xl font-bold text-blue-900">CHEM 1A Grade Tracker</h1>
                  <p className="text-gray-600 mt-1">General Chemistry I - Specifications Grading</p>
                </div>
                <div className="flex gap-2">
                  <button
                    onClick={exportData}
                    className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                  >
                    <i data-lucide="download" className="w-4 h-4"></i>
                    Export
                  </button>
                  <label className="flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors cursor-pointer">
                    <i data-lucide="upload" className="w-4 h-4"></i>
                    Import
                    <input type="file" accept=".json" onChange={importData} className="hidden" />
                  </label>
                </div>
              </div>

              {/* Time and Grade Overview */}
              <div className="grid grid-cols-2 gap-4 mt-4">
                <div className="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-lg">
                  <div className="flex items-center gap-2 mb-2">
                    <i data-lucide="clock" className="w-5 h-5"></i>
                    <span className="font-semibold">Time Remaining</span>
                  </div>
                  <div className="text-3xl font-bold">{weeksRemaining()} weeks</div>
                  <div className="text-sm mt-1 opacity-90">
                    Start: August 11, 2025
                  </div>
                  <div className="text-sm opacity-90">
                    End: December 12, 2025
                  </div>
                </div>

                <div className="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 rounded-lg">
                  <div className="flex items-center gap-2 mb-2">
                    <i data-lucide="award" className="w-5 h-5"></i>
                    <span className="font-semibold">Current Grade</span>
                  </div>
                  <div className="text-3xl font-bold">{getOverallGrade()}</div>
                  <div className="text-sm mt-1 opacity-90">Based on minimum component grade</div>
                  {!spiralsComplete && <div className="text-sm mt-1">‚ö†Ô∏è Complete all spirals</div>}
                </div>
              </div>
            </div>

            {/* Grade Summary Cards */}
            <div className="grid grid-cols-4 gap-4 mb-6">
              <div className="bg-white rounded-lg shadow p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Checkpoints</h3>
                <div className="text-2xl font-bold text-blue-600">{checkpointsCompleted}/10</div>
                <div className="text-lg font-semibold text-gray-800 mt-1">Grade: {checkpointGrade}</div>
                <div className="text-xs text-gray-500 mt-1">Need 10=A, 8=B, 7=C, 6=D</div>
              </div>

              <div className="bg-white rounded-lg shadow p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Mind Maps</h3>
                <div className="text-2xl font-bold text-green-600">{mindMapsCompleted}/10</div>
                <div className="text-lg font-semibold text-gray-800 mt-1">Grade: {mindMapGrade}</div>
                <div className="text-xs text-gray-500 mt-1">Need 10=A, 8=B, 7=C, 6=D</div>
              </div>

              <div className="bg-white rounded-lg shadow p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Labs</h3>
                <div className="text-2xl font-bold text-purple-600">{labsCompleted}/11</div>
                <div className="text-lg font-semibold text-gray-800 mt-1">Grade: {labGrade}</div>
                <div className="text-xs text-gray-500 mt-1">Need 11=A, 10=B, 9=C, 8=D</div>
              </div>

              <div className="bg-white rounded-lg shadow p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Spirals</h3>
                <div className="text-2xl font-bold text-orange-600">{spiralsCompleted}/6</div>
                <div className={`text-lg font-semibold mt-1 ${spiralsComplete ? 'text-green-600' : 'text-red-600'}`}>
                  {spiralsComplete ? '‚úì Complete' : '‚úó Required'}
                </div>
                <div className="text-xs text-gray-500 mt-1">All 6 mandatory</div>
              </div>
            </div>

            {/* Main Content Grid */}
            <div className="grid grid-cols-2 gap-6">
              {/* Objectives Column */}
              <div className="space-y-4">
                <div className="bg-white rounded-lg shadow-lg p-6">
                  <h2 className="text-xl font-bold text-blue-900 mb-4">Checkpoints</h2>
                  <div className="space-y-1">
                    {objectives.map(obj => (
                      <CheckboxItem
                        key={`cp-${obj}`}
                        checked={checkpoints[obj]}
                        onChange={() => toggleItem(setCheckpoints, obj)}
                        label={`Objective ${obj} Checkpoint`}
                      />
                    ))}
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-lg p-6">
                  <h2 className="text-xl font-bold text-green-900 mb-4">Mind Maps</h2>
                  <div className="space-y-1">
                    {objectives.map(obj => (
                      <CheckboxItem
                        key={`mm-${obj}`}
                        checked={mindMaps[obj]}
                        onChange={() => toggleItem(setMindMaps, obj)}
                        label={`Objective ${obj} Mind Map`}
                      />
                    ))}
                  </div>
                </div>
              </div>

              {/* Assignments Column */}
              <div className="space-y-4">
                <div className="bg-white rounded-lg shadow-lg p-6">
                  <h2 className="text-xl font-bold text-orange-900 mb-4">Spiral Assignments (All Required)</h2>
                  <div className="space-y-1">
                    {spirals.map(s => (
                      <CheckboxItem
                        key={`spiral-${s}`}
                        checked={spiralAssignments[s]}
                        onChange={() => toggleItem(setSpiralAssignments, s)}
                        label={`Spiral ${s}`}
                      />
                    ))}
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-lg p-6">
                  <h2 className="text-xl font-bold text-purple-900 mb-4">Labs</h2>
                  <div className="space-y-1">
                    {labs.map(l => (
                      <CheckboxItem
                        key={`lab-${l}`}
                        checked={labAssignments[l]}
                        onChange={() => toggleItem(setLabAssignments, l)}
                        label={`Lab ${l}`}
                      />
                    ))}
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-lg p-6">
                  <h2 className="text-xl font-bold text-red-900 mb-2">Final Examinations</h2>
                  <p className="text-sm text-gray-600 mb-3">Pass/Fail - Not factored into grade</p>
                  <div className="space-y-1">
                    <CheckboxItem
                      checked={lectureFinal}
                      onChange={() => {
                        setLectureFinal(!lectureFinal);
                        if (!lectureFinal) fireConfetti();
                      }}
                      label="Lecture Final (Must Pass)"
                    />
                    <CheckboxItem
                      checked={labFinal}
                      onChange={() => {
                        setLabFinal(!labFinal);
                        if (!labFinal) fireConfetti();
                      }}
                      label="Lab Final (Must Pass)"
                    />
                  </div>
                  {finalsComplete && (
                    <div className="mt-3 p-2 bg-green-50 border border-green-200 rounded text-sm text-green-700 font-medium">
                      ‚úì Both finals passed!
                    </div>
                  )}
                </div>
              </div>
            </div>

            {/* Footer Note */}
            <div className="mt-6 space-y-3">
              <div className="bg-blue-50 border-2 border-blue-200 rounded-lg p-4">
                <p className="text-sm text-gray-700">
                  <strong>üìä Grading System:</strong> Your current grade is the <strong>minimum</strong> of your three component grades (Checkpoints, Mind Maps, and Labs). 
                  All 6 Spirals are required. Both finals must be passed to receive your grade, but they don't change your grade calculation.
                </p>
              </div>
              <div className="bg-yellow-50 border-2 border-yellow-200 rounded-lg p-4">
                <p className="text-sm text-gray-700">
                  <strong>üíæ Important:</strong> Your progress is saved in memory during this session. 
                  Use <strong>Export</strong> to save your progress to a file, and <strong>Import</strong> to load it back later.
                </p>
              </div>
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<CHEM1ATracker />, document.getElementById('root'));
  </script>
</body>
</html>
